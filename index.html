<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pottery Studio Manager</title>
<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
<div id="error" style="background:red;color:white;padding:20px;display:none;">ERROR DETECTED - Check failed</div>
<div id="root"></div>
<script type="text/babel">
const {useState, useEffect} = React;
if (!window.supabase) {
  document.getElementById('error').style.display = 'block';
  document.getElementById('error').innerHTML = 'Supabase library failed to load';
}
if (!window.React) {
  document.getElementById('error').style.display = 'block';
  document.getElementById('error').innerHTML = 'React library failed to load';
}
const supabase = window.supabase.createClient(
  'https://bvciswqwilpqvcbqesyp.supabase.co',
  'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ2Y2lzd3F3aWxwcXZjYnFlc3lwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk4MjQ3MDAsImV4cCI6MjA4NTQwMDcwMH0.kgt86QcNIWLfLaEF8h5ZbGJ61nYXIFvNXvtfQcikiTM'
);

function App() {
const [view, setView] = useState(‘member’);
const [adminAuth, setAdminAuth] = useState(false);
const [adminPass, setAdminPass] = useState(’’);
const [members, setMembers] = useState([]);
const [entries, setEntries] = useState([]);
const [showAdd, setShowAdd] = useState(false);
const [loading, setLoading] = useState(false);

const [memberId, setMemberId] = useState(’’);
const [desc, setDesc] = useState(’’);
const [notes, setNotes] = useState(’’);
const [temp, setTemp] = useState(’’);
const [space, setSpace] = useState(’’);
const [width, setWidth] = useState(’’);
const [depth, setDepth] = useState(’’);
const [height, setHeight] = useState(’’);
const [photo, setPhoto] = useState(null);
const [preview, setPreview] = useState(null);
const [payment, setPayment] = useState(’’);

const [newName, setNewName] = useState(’’);
const [newEmail, setNewEmail] = useState(’’);

const rates = {
full: {label: ‘Full Kiln’, price: 65},
half: {label: ‘1/2 Kiln’, price: 40},
quarter: {label: ‘1/4 Kiln’, price: 25},
round8: {label: ‘1/2 Round Shelf (up to 8” tall)’, price: 20},
round3: {label: ‘1/2 Round Shelf (up to 3” tall)’, price: 10},
cubic: {label: ‘By Cubic Inch ($0.02/in³, $2 min)’, price: 0}
};

useEffect(() => {
loadMembers();
loadEntries();
}, []);

async function loadMembers() {
setLoading(true);
try {
const {data, error} = await supabase.from(‘members’).select(’*’).order(‘name’);
if (error) throw error;
setMembers(data || []);
} catch (e) {
console.error(e);
}
setLoading(false);
}

async function loadEntries() {
setLoading(true);
try {
const {data, error} = await supabase.from(‘entries’).select(’*’).order(‘created_at’, {ascending: false});
if (error) throw error;
setEntries(data || []);
} catch (e) {
console.error(e);
}
setLoading(false);
}

async function addMember() {
if (!newName || !newEmail) {
alert(‘Please enter name and email’);
return;
}
setLoading(true);
try {
const {error} = await supabase.from(‘members’).insert([{name: newName, email: newEmail}]);
if (error) throw error;
await loadMembers();
setNewName(’’);
setNewEmail(’’);
setShowAdd(false);
alert(‘Member added!’);
} catch (e) {
alert(’Error: ’ + e.message);
}
setLoading(false);
}

function calcCost() {
if (space === ‘cubic’) {
const w = parseFloat(width) || 0;
const d = parseFloat(depth) || 0;
const h = parseFloat(height) || 0;
return Math.max(w * d * h * 0.02, 2);
}
return rates[space] ? rates[space].price : 0;
}

function handlePhoto(e) {
const file = e.target.files[0];
if (!file) return;
if (file.size > 1024 * 1024) {
alert(‘Photo too large. Max 1MB’);
return;
}
const reader = new FileReader();
reader.onloadend = function() {
setPhoto(reader.result);
setPreview(reader.result);
};
reader.readAsDataURL(file);
}

async function submit() {
if (!memberId || !temp || !space || !payment) {
alert(‘Please fill required fields’);
return;
}
if (space === ‘cubic’ && (!width || !height || !depth)) {
alert(‘Please enter dimensions’);
return;
}

```
const member = members.find(m => m.id === parseInt(memberId));
const cost = calcCost();
setLoading(true);

try {
  const entry = {
    member_id: parseInt(memberId),
    member_name: member.name,
    member_email: member.email,
    description: desc || null,
    any_notes: notes || null,
    firing_temp: temp,
    kiln_space: rates[space].label,
    dimensions: space === 'cubic' ? width + '" × ' + depth + '" × ' + height + '"' : 'N/A',
    cubic_inches: space === 'cubic' ? parseFloat(width) * parseFloat(depth) * parseFloat(height) : null,
    cost: parseFloat(cost.toFixed(2)),
    photo: photo,
    payment_method: payment,
    status: payment === 'venmo' ? 'Paid via Venmo' : 'Bill End of Month'
  };
  
  const {error} = await supabase.from('entries').insert([entry]);
  if (error) throw error;
  
  await loadEntries();
  
  if (payment === 'venmo') {
    window.open('https://venmo.com/u/newcomb_BCAT?txn=pay&amount=' + cost.toFixed(2) + '&note=' + encodeURIComponent('Kiln firing - ' + member.name), '_blank');
  }
  
  setMemberId('');
  setDesc('');
  setNotes('');
  setTemp('');
  setSpace('');
  setWidth('');
  setDepth('');
  setHeight('');
  setPhoto(null);
  setPreview(null);
  setPayment('');
  
  alert('Entry submitted!');
} catch (e) {
  alert('Error: ' + e.message);
}
setLoading(false);
```

}

function exportCSV() {
const headers = [‘Date’, ‘Member’, ‘Email’, ‘Description’, ‘Notes’, ‘Temp’, ‘Space’, ‘Dimensions’, ‘Cost’, ‘Payment’, ‘Status’];
const rows = entries.map(e => [
new Date(e.created_at).toLocaleDateString(),
e.member_name,
e.member_email,
e.description || ‘’,
e.any_notes || ‘’,
e.firing_temp,
e.kiln_space,
e.dimensions,
e.cost,
e.payment_method === ‘venmo’ ? ‘Venmo’ : ‘Monthly’,
e.status
]);

```
const csv = [headers.join(',')].concat(rows.map(r => r.map(c => '"' + c + '"').join(','))).join('\n');
const blob = new Blob([csv], {type: 'text/csv'});
const url = window.URL.createObjectURL(blob);
const a = document.createElement('a');
a.href = url;
a.download = 'pottery-entries-' + new Date().toISOString().split('T')[0] + '.csv';
a.click();
```

}

function login() {
if (adminPass === ‘pottery2024’) {
setAdminAuth(true);
setAdminPass(’’);
} else {
alert(‘Incorrect password’);
setAdminPass(’’);
}
}

function logout() {
setAdminAuth(false);
setView(‘member’);
}

const totalUnbilled = entries.filter(e => e.status === ‘Bill End of Month’).reduce((sum, e) => sum + parseFloat(e.cost), 0).toFixed(2);

if (view === ‘member’) {
return (
<div className="min-h-screen bg-gray-50">
<div className="bg-black text-white py-6 px-6">
<div className="max-w-6xl mx-auto flex justify-between items-center">
<h1 className="text-3xl font-light">Pottery Studio Manager</h1>
<div className="flex gap-2">
<button onClick={() => setView(‘member’)} className=“px-4 py-2 rounded bg-blue-600”>Member Portal</button>
<button onClick={() => setView(‘admin’)} className=“px-4 py-2 rounded bg-gray-800 hover:bg-gray-700”>Admin Panel</button>
</div>
</div>
</div>

```
    <div className="max-w-6xl mx-auto px-6 py-12">
      <div className="bg-white border rounded-lg p-8">
        <h2 className="text-2xl font-light mb-6">Submit Piece for Firing</h2>
        
        {loading && <div className="text-center py-4 text-blue-600">Loading...</div>}
        
        <div className="space-y-5">
          <div>
            <label className="block text-sm font-medium mb-2">Select Your Name *</label>
            <select value={memberId} onChange={e => setMemberId(e.target.value)} className="w-full px-4 py-2 border rounded">
              <option value="">Choose your name...</option>
              {members.map(m => <option key={m.id} value={m.id}>{m.name}</option>)}
            </select>
          </div>
          
          <div>
            <label className="block text-sm font-medium mb-2">Description</label>
            <input type="text" value={desc} onChange={e => setDesc(e.target.value)} placeholder="e.g., Large bowl" className="w-full px-4 py-2 border rounded" />
          </div>
          
          <div>
            <label className="block text-sm font-medium mb-2">Any Notes?</label>
            <input type="text" value={notes} onChange={e => setNotes(e.target.value)} placeholder="e.g., Celadon glaze" className="w-full px-4 py-2 border rounded" />
          </div>
          
          <div>
            <label className="block text-sm font-medium mb-2">Firing Temperature *</label>
            <select value={temp} onChange={e => setTemp(e.target.value)} className="w-full px-4 py-2 border rounded">
              <option value="">Select...</option>
              <option value="Bisque (Cone 04)">Bisque (Cone 04)</option>
              <option value="Bisque (Cone 05)">Bisque (Cone 05)</option>
              <option value="Bisque (Cone 06)">Bisque (Cone 06)</option>
              <option value="Glaze (Cone 6)">Glaze (Cone 6)</option>
              <option value="Other">Other</option>
            </select>
          </div>
          
          <div>
            <label className="block text-sm font-medium mb-2">Kiln Space *</label>
            <select value={space} onChange={e => setSpace(e.target.value)} className="w-full px-4 py-2 border rounded">
              <option value="">Select...</option>
              <option value="full">Full Kiln - $65</option>
              <option value="half">1/2 Kiln - $40</option>
              <option value="quarter">1/4 Kiln - $25</option>
              <option value="round8">1/2 Round Shelf (up to 8" tall) - $20</option>
              <option value="round3">1/2 Round Shelf (up to 3" tall) - $10</option>
              <option value="cubic">By Cubic Inch ($0.02/in³, $2 min)</option>
            </select>
          </div>
          
          {space === 'cubic' && (
            <div className="bg-gray-50 p-4 rounded border">
              <h3 className="font-medium mb-3">Dimensions (inches)</h3>
              <div className="grid grid-cols-3 gap-4">
                <div>
                  <label className="block text-sm mb-1">Width *</label>
                  <input type="number" step="0.5" value={width} onChange={e => setWidth(e.target.value)} className="w-full px-3 py-2 border rounded" />
                </div>
                <div>
                  <label className="block text-sm mb-1">Depth *</label>
                  <input type="number" step="0.5" value={depth} onChange={e => setDepth(e.target.value)} className="w-full px-3 py-2 border rounded" />
                </div>
                <div>
                  <label className="block text-sm mb-1">Height *</label>
                  <input type="number" step="0.5" value={height} onChange={e => setHeight(e.target.value)} className="w-full px-3 py-2 border rounded" />
                </div>
              </div>
              <div className="mt-3 text-right">
                <span className="text-sm">Cost: </span>
                <span className="text-xl font-semibold text-green-600">${calcCost().toFixed(2)}</span>
              </div>
            </div>
          )}
          
          {space && space !== 'cubic' && (
            <div className="bg-green-50 p-4 rounded border border-green-200">
              <div className="text-right">
                <span className="text-sm">Cost: </span>
                <span className="text-2xl font-semibold text-green-700">${calcCost().toFixed(2)}</span>
              </div>
            </div>
          )}
          
          <div>
            <label className="block text-sm font-medium mb-2">Photo of Piece</label>
            <div className="flex items-center gap-4">
              <label className="cursor-pointer bg-gray-100 hover:bg-gray-200 px-4 py-2 rounded border">
                Upload Photo
                <input type="file" accept="image/*" onChange={handlePhoto} className="hidden" />
              </label>
              {preview && <img src={preview} alt="Preview" className="h-20 w-20 object-cover rounded border-2" />}
            </div>
            <p className="text-xs text-gray-500 mt-1">Max 1MB</p>
          </div>
          
          <div>
            <label className="block text-sm font-medium mb-2">Payment Method *</label>
            <div className="flex gap-4">
              <label className="flex items-center cursor-pointer bg-white border px-4 py-3 rounded">
                <input type="radio" name="pay" value="venmo" checked={payment === 'venmo'} onChange={e => setPayment(e.target.value)} className="mr-3" />
                <span className="font-medium text-blue-600">Pay Now via Venmo</span>
              </label>
              <label className="flex items-center cursor-pointer bg-white border px-4 py-3 rounded">
                <input type="radio" name="pay" value="monthly" checked={payment === 'monthly'} onChange={e => setPayment(e.target.value)} className="mr-3" />
                <span className="font-medium text-green-600">Bill at End of Month</span>
              </label>
            </div>
          </div>
          
          <button onClick={submit} disabled={loading} className="w-full bg-black hover:bg-gray-800 text-white py-3 rounded font-medium disabled:bg-gray-400">
            {loading ? 'Submitting...' : 'Submit for Firing'}
          </button>
        </div>
      </div>
    </div>
  </div>
);
```

}

if (!adminAuth) {
return (
<div className="min-h-screen bg-gray-50">
<div className="bg-black text-white py-6 px-6">
<div className="max-w-6xl mx-auto flex justify-between items-center">
<h1 className="text-3xl font-light">Pottery Studio Manager</h1>
<div className="flex gap-2">
<button onClick={() => setView(‘member’)} className=“px-4 py-2 rounded bg-gray-800 hover:bg-gray-700”>Member Portal</button>
<button onClick={() => setView(‘admin’)} className=“px-4 py-2 rounded bg-green-600”>Admin Panel</button>
</div>
</div>
</div>

```
    <div className="max-w-md mx-auto px-6 py-12">
      <div className="bg-white border rounded-lg p-8">
        <h2 className="text-2xl font-light mb-6 text-center">Admin Login</h2>
        <div className="space-y-4">
          <div>
            <label className="block text-sm font-medium mb-2">Password</label>
            <input type="password" value={adminPass} onChange={e => setAdminPass(e.target.value)} onKeyPress={e => e.key === 'Enter' && login()} placeholder="Enter admin password" className="w-full px-4 py-2 border rounded" />
          </div>
          <button onClick={login} className="w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded font-medium">Login</button>
        </div>
      </div>
    </div>
  </div>
);
```

}

return (
<div className="min-h-screen bg-gray-50">
<div className="bg-black text-white py-6 px-6">
<div className="max-w-6xl mx-auto flex justify-between items-center">
<h1 className="text-3xl font-light">Pottery Studio Manager</h1>
<div className="flex gap-2">
<button onClick={() => setView(‘member’)} className=“px-4 py-2 rounded bg-gray-800 hover:bg-gray-700”>Member Portal</button>
<button onClick={() => setView(‘admin’)} className=“px-4 py-2 rounded bg-green-600”>Admin Panel</button>
<button onClick={logout} className="px-4 py-2 rounded bg-red-600 hover:bg-red-700">Logout</button>
</div>
</div>
</div>

```
  <div className="max-w-6xl mx-auto px-6 py-12">
    {loading && <div className="text-center py-4 text-blue-600">Loading...</div>}
    
    <div className="grid grid-cols-3 gap-4 mb-6">
      <div className="bg-white border rounded-lg p-6">
        <p className="text-sm text-gray-600">Total Members</p>
        <p className="text-3xl font-light mt-1">{members.length}</p>
      </div>
      <div className="bg-white border rounded-lg p-6">
        <p className="text-sm text-gray-600">Total Entries</p>
        <p className="text-3xl font-light mt-1">{entries.length}</p>
      </div>
      <div className="bg-white border rounded-lg p-6">
        <p className="text-sm text-gray-600">Unbilled</p>
        <p className="text-3xl font-light text-green-700 mt-1">${totalUnbilled}</p>
      </div>
    </div>
    
    <div className="bg-white border rounded-lg p-6 mb-6">
      <div className="flex justify-between items-center mb-6">
        <h2 className="text-2xl font-light">Member Management</h2>
        <div className="flex gap-2">
          <button onClick={loadMembers} className="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded">Refresh</button>
          <button onClick={() => setShowAdd(!showAdd)} className="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded">Add Member</button>
        </div>
      </div>
      
      {showAdd && (
        <div className="mb-6 bg-gray-50 p-4 rounded border">
          <div className="grid grid-cols-2 gap-4">
            <div>
              <label className="block text-sm font-medium mb-1">Name</label>
              <input type="text" value={newName} onChange={e => setNewName(e.target.value)} className="w-full px-3 py-2 border rounded" />
            </div>
            <div>
              <label className="block text-sm font-medium mb-1">Email</label>
              <input type="email" value={newEmail} onChange={e => setNewEmail(e.target.value)} className="w-full px-3 py-2 border rounded" />
            </div>
          </div>
          <div className="mt-3 flex gap-2">
            <button onClick={addMember} disabled={loading} className="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded disabled:bg-gray-400">{loading ? 'Adding...' : 'Add'}</button>
            <button onClick={() => setShowAdd(false)} className="bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded">Cancel</button>
          </div>
        </div>
      )}
      
      <div className="space-y-2">
        {members.map(m => (
          <div key={m.id} className="p-3 bg-gray-50 rounded border">
            <p className="font-medium">{m.name}</p>
            <p className="text-sm text-gray-600">{m.email}</p>
          </div>
        ))}
      </div>
    </div>
    
    <div className="bg-white border rounded-lg p-6">
      <div className="flex justify-between items-center mb-6">
        <h2 className="text-2xl font-light">All Entries</h2>
        <div className="flex gap-2">
          <button onClick={loadEntries} className="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded">Refresh</button>
          <button onClick={exportCSV} className="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded">Export CSV</button>
        </div>
      </div>
      
      <div className="space-y-4">
        {entries.length === 0 ? (
          <p className="text-center text-gray-500 py-8">No entries yet</p>
        ) : (
          entries.map(e => (
            <div key={e.id} className="border rounded p-4">
              <div className="flex gap-4">
                {e.photo && <img src={e.photo} alt="Piece" className="w-24 h-24 object-cover rounded" />}
                <div className="flex-1">
                  <div className="flex justify-between items-start">
                    <div>
                      <p className="font-semibold">{e.member_name}</p>
                      <p className="text-sm text-gray-600">{e.description}</p>
                      <p className="text-xs text-gray-500 mt-1">{e.any_notes}</p>
                    </div>
                    <div className="text-right">
                      <p className="text-xl font-semibold text-green-700">${e.cost}</p>
                      <span className={'text-xs px-2 py-1 rounded ' + (e.status === 'Paid via Venmo' ? 'bg-blue-100 text-blue-800' : 'bg-green-100 text-green-800')}>
                        {e.status}
                      </span>
                    </div>
                  </div>
                  <div className="grid grid-cols-3 gap-2 mt-3 text-sm">
                    <div><span className="text-gray-500">Date:</span> {new Date(e.created_at).toLocaleDateString()}</div>
                    <div><span className="text-gray-500">Firing:</span> {e.firing_temp}</div>
                    <div><span className="text-gray-500">Space:</span> {e.kiln_space}</div>
                  </div>
                </div>
              </div>
            </div>
          ))
        )}
      </div>
    </div>
  </div>
</div>
```

);
}

ReactDOM.render(<App />, document.getElementById(‘root’));
</script>

</body>
</html>

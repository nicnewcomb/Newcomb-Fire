<!DOCTYPE html>

<html>
<head>
<title>Supabase Test</title>
<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
<h1>Testing Supabase Connection...</h1>
<div id="root"></div>
<div id="status"></div>

<script>
// Test if Supabase library loaded
if (window.supabase) {
  document.getElementById('status').innerHTML = '<p style="color:green">✓ Supabase library loaded</p>';
} else {
  document.getElementById('status').innerHTML = '<p style="color:red">✗ Supabase library FAILED to load</p>';
}
</script>

<script type="text/babel">
const {useState, useEffect} = React;

function App() {
  const [status, setStatus] = useState('Initializing...');
  const [members, setMembers] = useState([]);
  const [error, setError] = useState('');
  
  useEffect(function() {
    testConnection();
  }, []);
  
  async function testConnection() {
    try {
      setStatus('Creating Supabase client...');
      
      const supabase = window.supabase.createClient(
        'https://bvciswqwilpqvcbqesyp.supabase.co',
        'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ2Y2lzd3F3aWxwcXZjYnFlc3lwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk4MjQ3MDAsImV4cCI6MjA4NTQwMDcwMH0.kgt86QcNIWLfLaEF8h5ZbGJ61nYXIFvNXvtfQcikiTM'
      );
      
      setStatus('Client created! Fetching members...');
      
      const result = await supabase.from('members').select('*');
      
      if (result.error) {
        setError('Database error: ' + result.error.message);
        setStatus('Failed');
      } else {
        setMembers(result.data || []);
        setStatus('Success! Found ' + (result.data ? result.data.length : 0) + ' members');
      }
      
    } catch (e) {
      setError('Caught error: ' + e.message);
      setStatus('Failed with exception');
    }
  }
  
  return (
    <div style={{padding: '20px', fontFamily: 'sans-serif'}}>
      <h2>Connection Status: {status}</h2>
      
      {error && (
        <div style={{background: '#fee', border: '1px solid red', padding: '10px', marginTop: '10px'}}>
          <strong>Error:</strong> {error}
        </div>
      )}
      
      {members.length > 0 && (
        <div style={{marginTop: '20px'}}>
          <h3>Members found:</h3>
          <ul>
            {members.map(function(m) {
              return <li key={m.id}>{m.name} - {m.email}</li>;
            })}
          </ul>
        </div>
      )}
    </div>
  );
}

ReactDOM.render(<App />, document.getElementById('root'));
</script>

</body>
</html>
